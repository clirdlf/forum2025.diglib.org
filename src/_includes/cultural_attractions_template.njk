<section id="culture" class="transition-opacity duration-300 scroll-mt-60">
  <h2 class="text-3xl font-bold mb-6">Cultural Attractions</h2>

  <div class="mb-4">
    <label for="cultureTagFilter" class="block font-medium text-gray-700 mb-1">Filter by tag:</label>
    <div id="cultureTagButtons" class="flex flex-wrap gap-2">
      <button onclick="filterCultureByTag('')" class="tag-btn bg-gray-200 hover:bg-gray-300 text-sm px-3 py-1 rounded">All</button>
      <button onclick="filterCultureByTag('museum')" class="tag-btn bg-blue-100 hover:bg-blue-200 text-blue-800 text-sm px-3 py-1 rounded">Museum</button>
      <button onclick="filterCultureByTag('art')" class="tag-btn bg-blue-100 hover:bg-blue-200 text-blue-800 text-sm px-3 py-1 rounded">Art</button>
      <button onclick="filterCultureByTag('interactive')" class="tag-btn bg-blue-100 hover:bg-blue-200 text-blue-800 text-sm px-3 py-1 rounded">Interactive</button>
      <button onclick="filterCultureByTag('outdoor')" class="tag-btn bg-blue-100 hover:bg-blue-200 text-blue-800 text-sm px-3 py-1 rounded">Outdoor</button>
      <button onclick="filterCultureByTag('historic')" class="tag-btn bg-blue-100 hover:bg-blue-200 text-blue-800 text-sm px-3 py-1 rounded">Historic</button>
      <button onclick="filterCultureByTag('shopping')" class="tag-btn bg-blue-100 hover:bg-blue-200 text-blue-800 text-sm px-3 py-1 rounded">Shopping</button>
      <button onclick="filterCultureByTag('bookstore')" class="tag-btn bg-blue-100 hover:bg-blue-200 text-blue-800 text-sm px-3 py-1 rounded">Bookstore</button>
      <button onclick="filterCultureByTag('library')" class="tag-btn bg-blue-100 hover:bg-blue-200 text-blue-800 text-sm px-3 py-1 rounded">Library</button>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for place in cultural_attractions %}
    <div class="card culture-card border rounded-lg shadow p-4 bg-white {% if place.priority %}border-l-4 border-blue-500{% endif %}" data-tags="{{ place.tags | join(' ') }}">
      <h3 class="text-xl font-bold text-blue-700">
        <a href="{{ place.url }}" target="_blank">{{ place.name }}</a>
      </h3>
      {% if place.address.length %}
      <p class="flex items-center text-sm text-gray-600 mt-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" class="w-4 h-4 mr-1 fill-current text-gray-500">
          <path d="M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>
        <a href="https://www.google.com/maps/search/?api=1&query={{ place.address | urlencode }}" target="_blank" class="text-blue-700 underline">{{ place.address }}</a>
      </p>
      {% endif %}
      {% if place.distance %}
      <p class="flex items-center text-sm text-gray-600">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-4 h-4 mr-1 fill-current text-gray-500">
          <path d="M256 0C167.6 0 96 71.6 96 160c0 112 160 352 160 352s160-240 160-352c0-88.4-71.6-160-160-160zm0 224c-35.3 0-64-28.7-64-64s28.7-64 64-64s64 28.7 64 64s-28.7 64-64 64z"/></svg>
        {{ place.distance }} from hotel
      </p>
      {% endif %}
      <p class="mt-1 text-sm text-gray-700 flex items-start">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-4 h-4 mr-2 mt-1 fill-current text-gray-500">
          <path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg>
        {{ place.notes }}
      </p>
      {% if place.accessibility.length %}
      <p class="mt-1 text-sm text-gray-700 flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-4 h-4 mr-2 fill-current text-gray-500">
          <path d="M192 96a48 48 0 1 0 0-96 48 48 0 1 0 0 96zM120.5 247.2c12.4-4.7 18.7-18.5 14-30.9s-18.5-18.7-30.9-14C43.1 225.1 0 283.5 0 352c0 88.4 71.6 160 160 160c61.2 0 114.3-34.3 141.2-84.7c6.2-11.7 1.8-26.2-9.9-32.5s-26.2-1.8-32.5 9.9C240 440 202.8 464 160 464C98.1 464 48 413.9 48 352c0-47.9 30.1-88.8 72.5-104.8zM259.8 176l-1.9-9.7c-4.5-22.3-24-38.3-46.8-38.3c-30.1 0-52.7 27.5-46.8 57l23.1 115.5c6 29.9 32.2 51.4 62.8 51.4l5.1 0c.4 0 .8 0 1.3 0l94.1 0c6.7 0 12.6 4.1 15 10.4L402 459.2c6 16.1 23.8 24.6 40.1 19.1l48-16c16.8-5.6 25.8-23.7 20.2-40.5s-23.7-25.8-40.5-20.2l-18.7 6.2-25.5-68c-11.7-31.2-41.6-51.9-74.9-51.9l-68.5 0-9.6-48 63.4 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-76.2 0z"/></svg>
        <span> {{ place.accessibility | join(", ") }}</span>
      </p>
      {% endif %}
      {% if place.tags.length > 0 %}
      <p class="mt-2 text-sm text-gray-500 flex flex-wrap gap-1">
        {% for tag in place.tags %}
        <span class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-2 py-1 rounded">{{ tag }}</span>
        {% endfor %}
      </p>
      {% endif %}
    </div>
    {% endfor %}
  </div>

  <script>
    function filterCultureByTag(tag) {
      const cards = document.querySelectorAll('.culture-card');
      cards.forEach(card => {
        const tags = card.getAttribute('data-tags');
        card.style.display = !tag || tags.includes(tag) ? 'block' : 'none';
      });

      document.querySelectorAll('#cultureTagButtons .tag-btn').forEach(btn => btn.classList.remove('bg-blue-200'));
      if (tag) {
        const activeBtn = Array.from(document.querySelectorAll('#cultureTagButtons button')).find(b => b.textContent.toLowerCase() === tag);
        if (activeBtn) activeBtn.classList.add('bg-blue-200');
      }
    }
  </script>
</section>
